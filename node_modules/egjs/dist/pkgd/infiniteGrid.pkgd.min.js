/**
* Copyright (c) 2015 NAVER corp.
* egjs projects are licensed under the MIT license
* https://naver.github.io/egjs/license.txt
*
* egjs JavaScript library
* http://naver.github.io/egjs
*
* @version 1.5.0
* @SHA-1 a22f4c1 (1.5.0-rc)
*/
/**
* All-in-one packaged file for ease use of 'eg.infiniteGrid' with below dependencies.
* NOTE: This is not an official distribution file and is only for user convenience.
*
* src/module.js
* src/agent.js
* src/eg.js
* src/class.js
* src/component.js
* src/plugin/persist.js
* src/infiniteGrid.js
*/
!function(a,b,c){function d(a){return a>2?a+1+"th":m[a]}function e(a,b){var c;for(c in b)a=a.replace(new RegExp("{{"+c+"}}","gi"),b[c]);return a}function f(a,b){for(var f,g,h,i,j,m,n,o,p=0,q=b.length,r=[],s=[],t=c.require;q>p;p++)g=b[p],h={index:d(p),name:g,componentName:a},i="string"==typeof b[p],j=void 0===b[p],m=i&&(f=k[b[p]]),n=i&&f&&!c[b[p]],o=n&&t&&t.specified&&t.specified(b[p]),i||j?o&&t.defined(b[p])?(g=t(b[p]),s.push(g)):!o||t.defined(b[p])?n&&t&&t.specified&&!t.specified(b[p])?(h.url=f.url,r.push(e(l[1],h))):!n||t?m&&c[b[p]]?(g=c[b[p]],s.push(g)):!i||f?void 0!==b[p]||r.push(e(l[4],h)):r.push(e(l[3],h)):(h.url=f.url,r.push(e(l[2],h))):(h.url=f.url,r.push(e(l[0],h))):s.push(g);return[s,r]}function g(a){return a.charAt(0).toUpperCase()+a.slice(1)}function h(a){var c,d,e,f=g(a);if(!(i[f]&&i[f].prototype&&i[f].prototype._events))return!1;if(j.fn[a])throw new Error("The name '"+f+"' has already been used and registered as plugin. Try with different one.");j.fn[a]=function(c){var d,e;return"string"==typeof c?(d=this.data(b+"-"+a),"instance"===c?d:(e=d[c].apply(d,Array.prototype.slice.call(arguments,1)),e===d?this:e)):((void 0===c||j.isPlainObject(c))&&this.data(b+"-"+a,new i[f](this,c||{},a+":")),this)},e={trigger:"trigger",add:"on",remove:"off"},c=i[f].prototype._events();for(var h in c){d=j.event.special[a+":"+c[h]]={},d.setup=function(){return!0};for(var k in e)d[k]=function(c){return function(d,e){return j(this).data(b+"-"+a)[c](d.type,"trigger"===c?e:d.handler),!1}}(e[k])}}var i;c[b]||(c[b]={}),i=c[b];var j=c[a],k={jQuery:{url:"http://jquery.com/"},Hammer:{url:"http://hammerjs.github.io/"}},l=["[egjs] The {{name}} library must be loaded before {{componentName}}.",'[egjs] For AMD environment (like RequireJS), "{{name}}" must be declared, which is required by {{componentName}}.',"[egjs] The {{index}} argument of {{componentName}} is missing.\r\nDownload {{name}} from [{{url}}].","[egjs] The {{name}} parameter of {{componentName}} is not valid.\r\nPlease check and try again.","[egjs] The {{index}} argument of {{componentName}} is undefined.\r\nPlease check and try again."],m=["1st","2nd","3rd"],n=function(a){(n=c.console&&c.console.warn?function(a){c.console.warn(a)}:function(){})(a)};i.module||(i.module=function(a,b,d){var e=f(a,b);e[1].length?n(e[1].join("\r\n")):(d.apply(c,e[0]),h(a))})}("jQuery","eg",window),eg.module("agent",[eg],function(a){function b(a){return j(a,o.defaultString.browser)}function c(a){var b,c;return a?(c=h(a).versionSearch||a,b=d(c,n)):void 0}function d(a,b){var c,d,e=o.defaultString.browser.version,f=new RegExp("("+a+")","i").exec(b);return f?(d=f.index,a=f[0],d>-1&&(c=d+a.length+1,e=b.substring(c).split(" ")[0].replace(/_/g,".").replace(/\;|\)/g,"")),e):e}function e(a){return j(a,o.defaultString.os)}function f(a){var b,c,d,e,f=n,h=g(a)||{},i=o.defaultString.os.version;return a?h.versionAlias?h.versionAlias:(c=h.versionSearch||a,d=new RegExp("("+c+")\\s([\\d_\\.]+|\\d_0)","i"),e=d.exec(f),e&&(b=d.exec(f)[2].replace(/_/g,".").replace(/\;|\)/g,"")),b||i):void 0}function g(a){return i(o.os,a)}function h(a){return i(o.browser,a)}function i(a,b){for(var c,d,e,f=0;e=a[f];f++)if(c=e.criteria,d=new RegExp(e.identity,"i").test(b),c?d&&k(n,c):d)return e}function j(a,b){for(var c,d=0;c=a[d];d++)if(k(n,c.criteria))return c.identity||b.name;return b.name}function k(a,b){return b&&b.test?!!b.test(a):a.indexOf(b)>-1}function l(){for(var a,b,c=n,e=o.webview,f=!1,g=0;b=e[g];g++)if(k(c,b.criteria)&&(a=d(b.browserVersionSearch,c),k(c,b.webviewToken)||k(a,b.webviewBrowserVersion))){f=!0;break}return f}function m(a){return a.browser.name=a.browser.name.toLowerCase(),a.os.name=a.os.name.toLowerCase(),"ios"===a.os.name&&a.browser.webview&&(a.browser.version="-1"),a}var n,o={browser:[{criteria:"PhantomJS",identity:"PhantomJS"},{criteria:/Opera Mini/,identity:"Opera mini",versionSearch:"Opera Mini"},{criteria:/Opera|OPR/,identity:"Opera",versionSearch:"Opera|OPR"},{criteria:/Edge/,identity:"Edge",versionSearch:"Edge"},{criteria:/MSIE|Trident|Windows Phone/,identity:"IE",versionSearch:"IEMobile|MSIE|rv"},{criteria:/SAMSUNG|SamsungBrowser/,identity:"SBrowser",versionSearch:"Chrome"},{criteria:/Chrome|CriOS/,identity:"Chrome"},{criteria:/Android/,identity:"default"},{criteria:/iPhone|iPad/,identity:"Safari",versionSearch:"Version"},{criteria:"Apple",identity:"Safari",versionSearch:"Version"},{criteria:"Firefox",identity:"Firefox"}],os:[{criteria:/Windows Phone|Windows NT/,identity:"Window",versionSearch:"Windows Phone|Windows NT"},{criteria:"Windows 2000",identity:"Window",versionAlias:"5.0"},{criteria:/iPhone|iPad/,identity:"iOS",versionSearch:"iPhone OS|CPU OS"},{criteria:"Mac",versionSearch:"OS X",identity:"MAC"},{criteria:/Android/,identity:"Android"}],webview:[{criteria:/iPhone|iPad/,browserVersionSearch:"Version",webviewBrowserVersion:/-1/},{criteria:/iPhone|iPad|Android/,webviewToken:/NAVER|DAUM|; wv/}],defaultString:{browser:{version:"-1",name:"default"},os:{version:"-1",name:"unknown"}}};a.Agent={create:function(a){this.ua=n=a;var d={os:{},browser:{}};return d.browser.name=b(o.browser),d.browser.version=c(d.browser.name),d.os.name=e(o.os),d.os.version=f(d.os.name),d.browser.webview=l(),m(d)}}}),eg.module("eg",["jQuery",eg,window,eg.Agent],function(a,b,c,d){function e(a,b,c,d){var e=a.hook[b];return e&&(d=e.apply(a,c)),a[b]=function(){var e=a.hook[b];return e?e.apply(a,c):d},d}b.VERSION="1.5.0",b.hook={},b.agent=function(){var a=d.create(c.navigator.userAgent);return e(this,"agent",[a],a)},b.translate=function(a,b,c){return c=c||!1,"translate"+(c?"3d(":"(")+a+","+b+(c?",0)":")")},b.isHWAccelerable=function(){var a,c=!1,f=b.agent(),g=f.os.version,h=f.browser.name,i=f.browser.version;return-1!==h.indexOf("chrome")?c=i>="25":/ie|edge|firefox|safari|inapp/.test(h)?c=!0:-1!==f.os.name.indexOf("android")&&(a=(d.ua.match(/\(.*\)/)||[null])[0],c=g>="4.1.0"&&!/EK-GN120|SM-G386F/.test(a)||g>="4.0.3"&&/SHW-|SHV-|GT-|SCH-|SGH-|SPH-|LG-F160|LG-F100|LG-F180|LG-F200|EK-|IM-A|LG-F240|LG-F260/.test(a)&&!/SHW-M420|SHW-M200|GT-S7562/.test(a)),e(this,"isHWAccelerable",[c,f],c)},b.isTransitional=function(){var a=!1,c=b.agent(),d=c.browser.name;if(/chrome|firefox|sbrowser/.test(d))a=!0;else switch(c.os.name){case"ios":a=/safari|inapp/.test(d)&&parseInt(c.os.version,10)<6;break;case"window":a=/safari/.test(d)||/ie/.test(d)&&parseInt(c.browser.nativeVersion,10)>=10;break;default:a=/safari/.test(d)}return e(this,"isTransitional",[a,c],a)},b._hasClickBug=function(){var a=b.agent(),c="safari"===a.browser.name;return e(this,"_hasClickBug",[c,a],c)},a&&a.extend(a.easing,{easeOutCubic:function(a){return 1-Math.pow(1-a,3)}})}),eg.module("class",[eg],function(a){a.Class=function(a){var b=function(){"function"==typeof a.construct&&a.construct.apply(this,arguments)};return b.prototype=a,b.prototype.instance=function(){return this},b.prototype.constructor=b,b},a.Class.extend=function(a,b){var c=function(){a.apply(this,arguments),"function"==typeof b.construct&&b.construct.apply(this,arguments)},d=function(){};d.prototype=a.prototype;var e=new d;for(var f in b)e[f]=b[f];return e.constructor=c,c.prototype=e,c}}),eg.module("component",[eg],function(a){a.Component=a.Class({construct:function(){this.eventHandler={},this.options={}},option:function(a,b){if(arguments.length>=2)return this.options[a]=b,this;if("string"==typeof a)return this.options[a];if(0===arguments.length)return this.options;for(var c in a)this.options[c]=a[c];return this},trigger:function(a,b){b=b||{};var c=this.eventHandler[a]||[],d=c.length>0;if(!d)return!0;c=c.concat(),b.eventType=a;var e,f,g,h=!1,i=[b];for(b.stop=function(){h=!0},(f=arguments.length)>2&&(i=i.concat(Array.prototype.slice.call(arguments,2,f))),e=0;g=c[e];e++)g.apply(this,i);return!h},once:function(a,b){if("object"==typeof a&&"undefined"==typeof b){var c,d=a;for(c in d)this.once(c,d[c]);return this}if("string"==typeof a&&"function"==typeof b){var e=this;this.on(a,function f(){var c=Array.prototype.slice.call(arguments);b.apply(e,c),e.off(a,f)})}return this},hasOn:function(a){return!!this.eventHandler[a]},on:function(a,b){if("object"==typeof a&&"undefined"==typeof b){var c,d=a;for(c in d)this.on(c,d[c]);return this}if("string"==typeof a&&"function"==typeof b){var e=this.eventHandler[a];"undefined"==typeof e&&(e=this.eventHandler[a]=[]),e.push(b)}return this},off:function(a,b){if(0===arguments.length)return this.eventHandler={},this;if("undefined"==typeof b){if("string"==typeof a)return this.eventHandler[a]=void 0,this;var c=a;for(var d in c)this.off(d,c[d]);return this}var e=this.eventHandler[a];if(e){var f,g;for(f=0;g=e[f];f++)if(g===b){e.splice(f,1);break}}return this}})}),eg.module("persist",["jQuery",eg,window,document],function(a,b,c,d){function e(a){if(a){var b="__tmp__"+r;try{return a.setItem(b,r),a.getItem(b)===r}catch(c){return!1}}}function f(a){u=u||a.originalEvent&&a.originalEvent.persisted,!u&&v?t.trigger("persist"):g()}function g(){k(null)}function h(){var b,d=x?x.getItem(c.location.href+r):n.state;if(null===d)return{};var e,f="string"==typeof d&&d.length>0&&"null"!==d;try{if(b=q.parse(d),e=!("object"!==a.type(b)||b instanceof Array),!f||!e)throw new Error}catch(g){i(),b={}}return b}function i(){console.warn("window.history or session/localStorage has no valid format data to be handled in persist.")}function j(a){var b=h()[a];return("null"===b||"undefined"==typeof b)&&(b=null),b}function k(a){if(x)a?x.setItem(c.location.href+r,q.stringify(a)):x.removeItem(c.location.href+r);else try{n.replaceState(null===a?null:q.stringify(a),d.title,c.location.href)}catch(b){console.warn(b.message)}a?t.attr(r,!0):t.attr(r,null)}function l(a,b){var c=h();c[a]=b,k(c)}var m=c.performance,n=c.history,o=b.agent(),p=function(){var a=parseFloat(o.os.version);return!("ios"===o.os.name||"mac"===o.os.name&&"safari"===o.browser.name||"android"===o.os.name&&(4.3>=a&&o.browser.webview===!0||3>a))}(),q=c.JSON,r="___persist___",s="KEY"+r,t=a(c),u=t.attr(r)===!0,v=m&&m.navigation&&m.navigation.type===(m.navigation.TYPE_BACK_FORWARD||2),w="replaceState"in n&&"state"in n,x=function(){return e(c.sessionStorage)?c.sessionStorage:e(c.localStorage)?c.localStorage:void 0}();return w||x?q?(a.persist=function(a,b){var c;return"string"==typeof a?c=a:(c=s,b=1===arguments.length?a:null),(b||2===arguments.length)&&l(c,b),j(c)},a.persist.isNeeded=function(){return p},!v&&g(),a.event.special.persist={setup:function(){t.on("pageshow",f)},teardown:function(){t.off("pageshow",f)},trigger:function(a){a.state=j(s)}},{isBackForwardNavigated:v,onPageshow:f,reset:g,getState:h,setState:k,GLOBALKEY:s}):void console.warn("The JSON object is not supported in your browser.\r\nFor work around use polyfill which can be found at:\r\nhttps://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/JSON#Polyfill"):void 0}),eg.module("infiniteGrid",["jQuery",eg,window,document],function(a,b,c,d){var e={layoutComplete:"layoutComplete",append:"append",prepend:"prepend"},f=3;b.InfiniteGrid=b.Class.extend(b.Component,{_events:function(){return e},construct:function(b,d,e){var f=c.navigator.userAgent;this.options=a.extend({isEqualSize:!1,defaultGroupKey:null,count:30,threshold:300},d),this.$el=b instanceof a?b:a(b),this.el=this.$el.get(0),this.el.style.position="relative",this._prefix=e||"",this._isIos=/iPhone|iPad/.test(f),this._isIE=/MSIE|Trident|Windows Phone|Edge/.test(f),this._appendCols=this._prependCols=[],this.$view=a(c),this._reset(),this._refreshViewport(),this.el.children.length>0&&this.layout(!0,this._itemize(a.makeArray(this.el.children),this.options.defaultGroupKey)),this._onScroll=a.proxy(this._onScroll,this),this._onResize=a.proxy(this._onResize,this),this.$view.on("scroll",this._onScroll).on("resize",this._onResize)},_getScrollTop:function(){return d.body.scrollTop||d.documentElement.scrollTop},_onScroll:function(){if(!this.isProcessing()){var b=this._getScrollTop(),c=this._prevScrollTop;if(!(this._isIos&&0===b||c===b)){var d,f;if(b>c){if(a.isEmptyObject(this._bottomElement)&&(this._bottomElement=this.getBottomElement(),null==this._bottomElement))return;d=this._bottomElement,f=d.getBoundingClientRect(),f.top<=this._clientHeight+this.options.threshold&&this.trigger(this._prefix+e.append,{scrollTop:b})}else{if(a.isEmptyObject(this._topElement)&&(this._topElement=this.getTopElement(),null==this._topElement))return;if(d=this._topElement,f=d.getBoundingClientRect(),f.bottom>=-this.options.threshold){var g=this.fit();g>0&&(b-=g,this.$view.scrollTop(b)),this.trigger(this._prefix+e.prepend,{scrollTop:b})}}this._prevScrollTop=b}}},_onResize:function(){this._resizeTimeout&&clearTimeout(this._resizeTimeout);var a=this;this._resizeTimeout=setTimeout(function(){a._refreshViewport(),a.$el.innerWidth()!==a._containerWidth&&a.layout(!0),a._resizeTimeout=null,a._prevScrollTop=-1},100)},_refreshViewport:function(){var b=this.$view.get(0);b&&(this._clientHeight=a.isWindow(b)?b.innerHeight||document.documentElement.clientHeight:b.clientHeight)},getStatus:function(){var b,c={};for(b in this)!this.hasOwnProperty(b)||!/^_/.test(b)||"function"==typeof this[b]||this[b]instanceof Element||(c[b]=this[b]);return{prop:c,options:a.extend({},this.options),items:a.map(this.items,function(b){var c=a.extend({},b);return delete c.el,c}),html:this.el.innerHTML,cssText:this.el.style.cssText}},setStatus:function(b){return b&&b.cssText&&b.html&&b.prop&&b.items?(this.el.style.cssText=b.cssText,this.el.innerHTML=b.html,a.extend(this,b.prop),this._topElement=this._bottomElement=null,this.items=a.map(this.el.children,function(a,c){return b.items[c].el=a,b.items[c]}),this):this},isProcessing:function(){return this._isProcessing},isRecycling:function(){return this.options.count>0&&this._isRecycling},getGroupKeys:function(){return a.map(this.items,function(a){return a.groupKey})},layout:function(b,c,d){var e=a.extend({isAppend:!0,removedCount:0},d);return b="undefined"==typeof b||b,c||e.isAppend||(e.isAppend=!0),this._waitResource(b,e.isAppend?c:c.reverse(),e),this},_layoutComplete:function(b,c,d){var e=!this.items.length;c&&d.isAppend&&(this.items=this.items.concat(c)),e&&a.each(c,function(a,b){b.el.style.position="absolute"}),e||b?this._resetCols(this._measureColumns()):c||(this._appendCols=this._prependCols.concat()),this._layoutItems(b,c,d),this._postLayout(b,c,d)},_layoutItems:function(b,c,d){var e=this,f=c||this.items;if(a.each(f,function(a,c){c.position=e._getItemLayoutPosition(b,c,d.isAppend)}),c&&!d.isAppend){this.items=c.sort(function(a,b){return a.position.y-b.position.y}).concat(this.items);var g=this._getTopPositonY();0!==g&&(f=this.items,a.each(f,function(a,b){b.position.y-=g}),this._syncCols(!1),this._syncCols(!0))}a.each(f,function(a,b){if(b.el){var c=b.el.style;c.left=b.position.x+"px",c.top=b.position.y+"px"}})},append:function(b,c){return this._isProcessing||0===b.length?void 0:(b=a(b),this._insert(b,c,!0),b.length)},prepend:function(b,c){return this._isProcessing||0===b.length?void 0:(b=a(b),this._insert(b,c,!1),b.length)},clear:function(){return this.el.innerHTML="",this.el.style.height="",this._reset(),this},getTopElement:function(){var a=this._getTopItem();return a&&a.el},_getTopItem:function(){var b=null,c=1/0;return a.each(this._getColItems(!1),function(a,d){d&&d.position.y<c&&(c=d.position.y,b=d)}),b},_getTopPositonY:function(){var a=this._getTopItem();return a?a.position.y:0},getBottomElement:function(){var b,c=null,d=-(1/0);return a.each(this._getColItems(!0),function(a,e){b=e?e.position.y+e.size.height:0,b>=d&&(d=b,c=e)}),c&&c.el},_postLayout:function(a,b,c){if(this._isProcessing){b=b||[],this.el.style.height=this._getContainerSize().height+"px",this._doubleCheckCount=f,this._topElement=this.getTopElement(),this._bottomElement=this.getBottomElement();var d=0;if(c.isAppend||(d=b.length>=this.items.length?0:this.items[b.length].position.y,d>0&&(this._prevScrollTop=this._getScrollTop()+d,this.$view.scrollTop(this._prevScrollTop))),this._isProcessing=!1,this.trigger(this._prefix+e.layoutComplete,{target:b.concat(),isAppend:c.isAppend,distance:d,croppedCount:c.removedCount}),!c.isAppend&&0===this._getScrollTop()){var g=this;clearInterval(this._doubleCheckTimer),this._doubleCheckTimer=setInterval(function(){0===g._getScrollTop()&&(g.trigger(g._prefix+e.prepend,{scrollTop:0}),--g._doubleCheckCount<=0&&clearInterval(g._doubleCheckTimer))},500)}}},_insert:function(b,c,d){if(this._isProcessing=!0,this.isRecycling()||(this._isRecycling=this.items.length+b.length>=this.options.count),0!==b.length){var e=b.toArray(),f=a(e),g=-this._clientHeight+"px";a.each(e,function(a,b){b.style.position="absolute",b.style.top=g});var h=this._adjustRange(d,f);this.$el[d?"append":"prepend"](f),this.layout(!1,this._itemize(f,c),{isAppend:d,removedCount:h})}},_waitResource:function(a,b,c){this._isProcessing=!0;var d=this._checkImageLoaded(),e=this,f=function(){e._layoutComplete(a,b,c)};d.length>0?this._waitImageLoaded(d,f):setTimeout(function(){f&&f()},0)},_adjustRange:function(b,c){var d=0;if(!this.isRecycling())return d;this.options.count<=c.length&&(d+=b?c.splice(0,c.length-this.options.count).length:c.splice(this.options.count).length);var e,f,g=this.items.length+c.length-this.options.count;return 0>=g||(f=this._getDelimiterIndex(b,g))<0?d:(b?(e=this.items.splice(0,f),this._syncCols(!1)):(e=f===this.items.length?this.items.splice(0):this.items.splice(f,this.items.length-f),this._syncCols(!0)),a.each(e,function(a,b){f=c.index(b.el),-1!==f?c.splice(f,1):b.el.parentNode.removeChild(b.el)}),d+=e.length)},_getDelimiterIndex:function(a,b){var c=this.items.length;if(c===b)return c;var d,e=0,f=a?b-1:c-b,g=f+(a?1:-1),h=this.items[f].groupKey;if(null!=h&&h===this.items[g].groupKey)if(a){for(d=f;d>0&&h===this.items[d].groupKey;d--);e=0===d?-1:d+1}else{for(d=f;c>d&&h===this.items[d].groupKey;d++);e=d===c?-1:d}else e=a?g:f;return e},_fit:function(b){if(this.options.count<=0)return this._fit=function(){return 0},0;var c=this._getTopPositonY();return 0!==c&&(a.each(this.items,function(a,d){d.position.y-=c,b&&(d.el.style.top=d.position.y+"px")}),this._syncCols(!1),this._syncCols(!0),b&&(this.el.style.height=this._getContainerSize().height+"px")),c},fit:function(){return this._fit(!0)},_reset:function(){this._isProcessing=!1,this._topElement=null,this._bottomElement=null,this._isRecycling=!1,this._prevScrollTop=0,this._equalItemSize=0,this._resizeTimeout=null,this._doubleCheckTimer=null,this._doubleCheckCount=f,this._resetCols(this._appendCols.length||0),this.items=[]},_checkImageLoaded:function(){return this.$el.find("img").filter(function(b,c){return c.nodeType&&-1!==a.inArray(c.nodeType,[1,9,11])?!c.complete:void 0}).toArray()},_waitImageLoaded:function(b,c){var d,e=b.length,f=function(b){e--,a(b.target).off("load error"),0>=e&&c&&c()},g=this;a.each(b,function(b,c){if(d=a(c),g._isIE){var e=c.getAttribute("src");c.setAttribute("src",""),c.setAttribute("src",e)}d.on("load error",f)})},_measureColumns:function(){this.el.style.width=null,this._containerWidth=this.$el.innerWidth(),this._columnWidth=this._getColumnWidth()||this._containerWidth;var a=this._containerWidth/this._columnWidth,b=this._columnWidth-this._containerWidth%this._columnWidth;return a=Math.max(Math[b&&1>=b?"round":"floor"](a),1),a||0},_resetCols:function(a){a="undefined"==typeof a?0:a;for(var b=[];a--;)b.push(0);this._appendCols=b.concat(),this._prependCols=b.concat()},_getContainerSize:function(){return{height:Math.max.apply(Math,this._appendCols),width:this._containerWidth}},_getColumnWidth:function(){var b=this.items[0]&&this.items[0].el,c=0;if(b){var d=a(b);c=d.innerWidth(),this.options.isEqualSize&&(this._equalItemSize={width:c,height:d.innerHeight()})}return c},_syncCols:function(a){if(this.items.length){var b,c=this._getColItems(a),d=a?this._appendCols:this._prependCols,e=d.length;for(b=0;e>b;b++)d[b]=c[b].position.y+(a?c[b].size.height:0)}},_getColIdx:function(a){return parseInt(a.position.x/parseInt(this._columnWidth,10),10)},_getColItems:function(a){for(var b,c,d=this._appendCols.length,e=new Array(d),f=0,g=a?this.items.length-1:0;b=this.items[g];){if(c=this._getColIdx(b),!e[c]&&(e[c]=b,++f===d))return e;g+=a?-1:1}return e},_itemize:function(b,c){return a.map(b,function(a){return{el:a,position:{x:0,y:0},groupKey:"undefined"==typeof c?null:c}})},_getItemLayoutPosition:function(b,c,d){if(c&&c.el){var e=a(c.el);(b||!c.size)&&(c.size=this._getItemSize(e));var f,g=d?this._appendCols:this._prependCols,h=Math[d?"min":"max"].apply(Math,g);if(d)f=a.inArray(h,g);else for(var i=g.length;i-->=0;)if(g[i]===h){f=i;break}return g[f]=h+(d?c.size.height:-c.size.height),{x:this._columnWidth*f,y:d?h:h-c.size.height}}},_getItemSize:function(a){return this._equalItemSize||{width:a.innerWidth(),height:a.innerHeight()}},remove:function(b){for(var c=null,d=-1,e=0,f=this.items.length;f>e;e++)if(this.items[e].el===b){d=e;break}return~d&&(c=a.extend({},this.items[d]),this.items.splice(d,1),c.el.parentNode.removeChild(c.el)),c},destroy:function(){this.off(),this.$view.off("resize",this._onResize).off("scroll",this._onScroll),this._reset()}})});